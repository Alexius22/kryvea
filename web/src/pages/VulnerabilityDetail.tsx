import { mdiFileEdit } from "@mdi/js";
import { useEffect } from "react";
import { useNavigate, useParams } from "react-router";
import Card from "../components/CardBox/Card";
import CardTitle from "../components/CardBox/CardTitle";
import Button from "../components/Form/Button";
import SectionTitleLineWithButton from "../components/Section/SectionTitleLineWithButton";
import { getPageTitle } from "../config";
import { vulnerabilities } from "../mockup_data/vulnerabilities";

const vulnerability = vulnerabilities[0];

export default function VulnerabilityDetail() {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const loading = false;
  const error = false;

  useEffect(() => {
    document.title = getPageTitle("Vulnerability detail");
  }, []);
  return (
    <div>
      <SectionTitleLineWithButton icon={undefined} title={vulnerability.detailed_title} main>
        <Button icon={mdiFileEdit} text="Edit PoC" small onClick={() => navigate("/edit_poc")} />
      </SectionTitleLineWithButton>

      <Card className="mb-6 flex overflow-hidden !p-0">
        <table className="table">
          <thead>
            <tr>
              <th className="!text-center">Severity</th>
              <th className="!text-center">Host</th>
              <th className="!text-center">User</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td className="text-center">{vulnerability.cvss_severity}</td>
              <td className="text-center">{vulnerability.target.ip + " - " + vulnerability.target.hostname}</td>
              <td className="text-center">{vulnerability.user.username}</td>
            </tr>
          </tbody>
        </table>

        <table className="table">
          <tbody>
            <tr>
              <th>Generic description</th>
              <td>{vulnerability.generic_description.text}</td>
            </tr>
            <tr>
              <th>Detailed description</th>
              <td>{vulnerability.description}</td>
            </tr>
            <tr>
              <th>CVSS score</th>
              <td>{vulnerability.cvss_score}</td>
            </tr>
            <tr>
              <th>CVSS vector</th>
              <td>{vulnerability.cvss_vector}</td>
            </tr>
            <tr>
              <th>CVSS Description</th>
              <td>{vulnerability.cvss_description}</td>
            </tr>
            <tr>
              <th>Remediation</th>
              <td>{vulnerability.generic_remediation.text}</td>
            </tr>
            <tr>
              <th>References</th>
              <td>
                {" "}
                <ul>
                  {vulnerability.references.map((reference, index) => (
                    <li key={index}>{reference}</li>
                  ))}
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </Card>
      <Card>
        <CardTitle title="Proof of Concept"></CardTitle>
        <div className="max-w-full p-2">
          <section>
            <p className="mb-6">This example shows a typical HTTP GET request and its response:</p>
            <div className="flex gap-6">
              {/* HTTP Request */}
              <div className="req-res-text">
                <h3 className="req-res">HTTP Request</h3>
                <pre>
                  <code>
                    {`GET /api/users/123 HTTP/1.1
Host: example.com
Accept: application/json
Authorization: Bearer abcdef1234567890`}
                  </code>
                </pre>
              </div>

              {/* HTTP Response */}
              <div className="req-res-text">
                <h3 className="req-res">HTTP Response</h3>
                <pre>
                  <code>
                    {`HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 85

{
  "id": 123,
  "name": "John Doe",
  "email": "john.doe@example.com"
}`}
                  </code>
                </pre>
              </div>
            </div>
          </section>

          {/* 2. Image with caption */}
          <section className="mt-12">
            <p className="mb-4">Below is an example image with a descriptive caption explaining its content:</p>
            <figure className="inline-block text-center">
              <img src="https://upload.wikimedia.org/wikipedia/commons/f/f1/Vitejs-logo.svg" className="poc-img" />
              <figcaption className="mt-2 text-sm italic">This is a sample caption for the image above</figcaption>
            </figure>
          </section>

          {/* 3. Syntax highlighted code snippet */}
          <section className="mt-12">
            <p className="mb-4">This snippet demonstrates a simple JavaScript function that adds two numbers:</p>
            <pre className="req-res-text">
              <code>
                {`// Function to add two numbers
function add(a, b) {
  return a + b;
}

console.log(add(3, 4)); // Output: 7
`}
              </code>
            </pre>
          </section>
        </div>
      </Card>
    </div>
  );
}
